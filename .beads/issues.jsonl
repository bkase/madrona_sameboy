{"id":"bd-12v","title":"Investigate GPU perf vs CuLE (multi-world)","description":"Goal: comprehensive instrumentation/investigation of GPU performance vs CPU, cross-referenced against CuLE paper and reference implementation.\n\nIncludes:\n- Multi-world CPU vs GPU throughput sweeps (vary worlds, frames) with benchmark mode.\n- Nsight Systems multi-world traces.\n- Nsight Compute kernel analysis (occupancy, memory, IPC).\n- Extract CuLE paper via markitdown; save markdown in docs/ for analysis.\n- Cross-reference NVlabs/cule repo for runtime design differences.\n- Produce prioritized hypotheses (each a bead under this epic) and falsify/fix one by one.\n- Log experiments in history/experiments.md and learnings in history/learnings.md.","status":"open","priority":1,"issue_type":"epic","created_at":"2026-01-20T15:11:55.133306995Z","created_by":"bkase","updated_at":"2026-01-20T15:11:55.133306995Z","compaction_level":0,"original_size":0}
{"id":"bd-134","title":"Wire world state memory bindings for Madrona","description":"Scope:\n- Ensure one GBMachine per world and GBState owns GB_gameboy_t.\n- Bind WRAM/VRAM/MBC RAM SoA components to gb->ram/gb->vram/gb->mbc_ram each tick or during init.\nFiles:\n- src/types.hpp\n- src/sim.cpp\n- src/sim.hpp\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 60 1","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.674790273Z","created_by":"bkase","updated_at":"2026-01-20T07:12:56.637806891Z","closed_at":"2026-01-20T07:12:56.637749178Z","close_reason":"Bound SoA RAM/VRAM/MBC RAM/ROM as external; cpu_instrs still not done at 60f","compaction_level":0,"original_size":0}
{"id":"bd-13r","title":"Prioritize GPU perf hypotheses","description":"Synthesize CuLE paper/repo + profiling + benchmarks into prioritized hypotheses. Each hypothesis should be its own child bead under bd-12v with a clear falsification test.","notes":"Prioritized hypotheses (based on nsys + sweeps): (1) Megakernel compute dominates frame time (nsys: madronaMWGPUMegakernel_256_1_48 ~390 ms per frame @512 worlds), so bottleneck is inside emulation kernel (branchy scalar CPU emu on GPU) rather than launch overhead. (2) GPU underutilization/occupancy due to per-world scalar threads and high register pressure; need perf counters (ncu blocked by ERR_NVGPUCTRPERM) to confirm. (3) ECS/SoA memory layout or cache thrash inflates kernel time (needs memory throughput/cache metrics once counters enabled). (4) Launch overhead seems minor (cuGraphLaunch ~3–4 µs), so multi-frame per launch may help but is unlikely primary cause. Evidence: GPU total FPS scales sublinearly to ~2k FPS at 1024 worlds, far below CPU ~40k FPS, pointing to kernel inefficiency vs CuLE’s specialized GPU design.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:30.433973967Z","created_by":"bkase","updated_at":"2026-01-20T15:34:50.443107527Z","closed_at":"2026-01-20T15:34:50.443051815Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-13r","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:30.449784431Z","created_by":"bkase"}]}
{"id":"bd-15j","title":"Batch multiple frames per step to reduce GPU launch overhead","description":"Scope:\n- Add a config option to batch multiple frames per step on GPU to reduce kernel launch overhead.\n- Update headless_gpu CLI to pass a frames-per-step parameter.\nFiles:\n- src/headless_gpu.cpp\n- src/sim.hpp\n- src/sim.cpp\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 120 1 0","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-20T03:47:04.802521187Z","created_by":"bkase","updated_at":"2026-01-20T03:47:04.802521187Z","compaction_level":0,"original_size":0}
{"id":"bd-16f","title":"CPU/GPU compare harness: key register comparison","description":"Scope:\n- Compare PC/SP/LY/STAT after N frames in the CPU/GPU harness and report mismatches.\n- Ensure register reads are taken at the same frame boundary.\nFiles:\n- src/compare_cpu_gpu.cpp\n- vendored/SameBoy/Core/gb.h\nValidation:\n- cmake --build build --target compare_cpu_gpu\n- ./build/compare_cpu_gpu cpu_instrs.gb 120","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:04.055103619Z","created_by":"bkase","updated_at":"2026-01-20T07:27:24.007433313Z","closed_at":"2026-01-20T07:27:24.007407457Z","close_reason":"Regs compare added; cpu_instrs.gb mismatch","compaction_level":0,"original_size":0}
{"id":"bd-1au","title":"Compile-out debugger, cheats, rewind in GPU build","description":"Scope:\n- Ensure GB_DISABLE_DEBUGGER, GB_DISABLE_CHEATS, and GB_DISABLE_REWIND fully remove host-only logic from GPU builds.\n- Remove or guard any remaining references to debugger/cheats/rewind modules in GPU compilation.\nFiles:\n- vendored/SameBoy/Core/debugger.c\n- vendored/SameBoy/Core/cheats.c\n- vendored/SameBoy/Core/cheat_search.c\n- vendored/SameBoy/Core/rewind.c\n- src/CMakeLists.txt\nValidation:\n- cmake --build build --target headless_gpu","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:02.410203848Z","created_by":"bkase","updated_at":"2026-01-20T16:28:51.405106362Z","closed_at":"2026-01-20T16:28:51.405049833Z","close_reason":"Already disabled in GPU builds via Core/sameboy_gpu_config.h (GB_GPU_BUILD include in defs.h) which defines GB_DISABLE_DEBUGGER/CHEATS/REWIND.","compaction_level":0,"original_size":0}
{"id":"bd-1ed","title":"Wire SameBoy GPU TU into NVRTC compilation defs","description":"Scope:\n- Ensure the GPU aggregation TU is included in MADRONA_SAMEBOY_SIM_SRCS so NVRTC compiles SameBoy core code.\n- Verify MADRONA_SAMEBOY_COMPILE_FLAGS includes the SameBoy include paths and GPU config defines.\nFiles:\n- src/CMakeLists.txt\n- src/headless_gpu.cpp\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 10 1 0","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:01.794847487Z","created_by":"bkase","updated_at":"2026-01-20T04:11:40.297947220Z","closed_at":"2026-01-20T04:11:40.297921107Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-1el","title":"Nsight Compute kernel analysis","description":"Use ncu to analyze key kernels (occupancy, memory throughput, divergence). Record findings and candidate bottlenecks in history/experiments.md.","notes":"Tried ncu with --set speed (invalid set) then --set basic targeting madronaMWGPUMegakernel_256_1_48. Nsight Compute failed to collect metrics due to ERR_NVGPUCTRPERM (GPU performance counters disabled). Report file from first run: history/ncu_megakernel.ncu-rep (no metrics).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:24.653450073Z","created_by":"bkase","updated_at":"2026-01-20T15:33:37.591952191Z","closed_at":"2026-01-20T15:33:37.591924894Z","close_reason":"Blocked: GPU performance counters disabled (ERR_NVGPUCTRPERM)","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1el","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:24.659984333Z","created_by":"bkase"}]}
{"id":"bd-1g8","title":"Fix warnings, require warnings-as-errors build, enforce in precommit","description":"Fix all build warnings. Update AGENTS.md to state we always build with warnings-as-errors, and ensure this is enforced in the pre-commit hook if configured.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T07:28:49.447069917Z","created_by":"bkase","updated_at":"2026-01-20T08:15:40.487280378Z","closed_at":"2026-01-20T08:15:40.487224889Z","close_reason":"Warnings fixed or suppressed; Werror enabled; pre-commit hook added","compaction_level":0,"original_size":0}
{"id":"bd-1hs","title":"Gate scanline PPU and hook into GB_advance_cycles","description":"Scope:\n- Add a fast PPU mode flag (gb->fast_ppu or gb->ppu_mode) and route GB_advance_cycles to GB_display_run_scanline when enabled.\n- Keep the existing dot-accurate path available when fast mode is off.\nFiles:\n- vendored/SameBoy/Core/gb.c\n- vendored/SameBoy/Core/display.c\n- vendored/SameBoy/Core/gb.h\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 600 1","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.588086837Z","created_by":"bkase","updated_at":"2026-01-20T07:10:33.179028017Z","closed_at":"2026-01-20T07:10:33.178972257Z","close_reason":"Implemented fast_ppu gating; cpu_instrs still not done at 600f","compaction_level":0,"original_size":0}
{"id":"bd-1po","title":"Hypothesis: GPU underutilized (low occupancy / single-thread per world)","description":"Test occupancy and SM utilization with ncu; sweep world counts and thread/block sizing if configurable. Consider batching multiple GBs per block or increasing parallelism in task graph.","notes":"Tried to increase blocks/SM via MADRONA_MWGPU_ENABLE_PGO=1 (and intended MADRONA_MWGPU_EXEC_CONFIG_OVERRIDE). NVJitLink fails compiling megakernel variants (256_{2..6}_48) due to max-regcount mismatch with internal functions, so occupancy tuning is currently blocked until regcount constraints are fixed.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T15:12:40.036111084Z","created_by":"bkase","updated_at":"2026-01-20T15:47:15.849625036Z","closed_at":"2026-01-20T15:47:15.849598124Z","close_reason":"Blocked: MADRONA_MWGPU_ENABLE_PGO compile fails (regcount mismatch)","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1po","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:40.052987087Z","created_by":"bkase"}]}
{"id":"bd-1rg","title":"Pack 4 pixels per byte into GBObsPacked and update types","description":"Scope:\n- Replace GBObs with a packed 2-bit format (4 pixels per byte, row-major, leftmost pixel in lowest 2 bits).\n- Update component sizes and constants to reflect 80x72 packed output (1440 bytes).\nFiles:\n- src/types.hpp\n- src/consts.hpp\n- src/sim.cpp\nValidation:\n- cmake --build build --target headless","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.175153300Z","created_by":"bkase","updated_at":"2026-01-20T03:47:03.175153300Z","compaction_level":0,"original_size":0}
{"id":"bd-1rh","title":"Skip/decimate PPU rendering when obs not needed","description":"CuLE avoids calling TIA kernel every frame (ALE uses max over 2 of 4 frames). Explore skipping PPU/render work on non-observation frames or render-every-N policy; quantify throughput vs accuracy.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T22:19:22.315006551Z","created_by":"bkase","updated_at":"2026-01-20T22:19:22.330796735Z","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1rh","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T22:19:22.330774607Z","created_by":"bkase"}]}
{"id":"bd-1rp","title":"Define divergence thresholds and document tolerable drift","description":"Scope:\n- Document acceptable CPU/GPU drift thresholds and how to interpret comparison output.\n- Record decisions for tolerable mismatches (if any) and how to track them.\nFiles:\n- docs/determinism.md (new)\n- src/compare_cpu_gpu.cpp\nValidation:\n- ./build/compare_cpu_gpu cpu_instrs.gb 120 --report build/diff_report.json","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:04.225238908Z","created_by":"bkase","updated_at":"2026-01-20T07:33:42.376652009Z","closed_at":"2026-01-20T07:33:42.376625737Z","close_reason":"Documented thresholds and added --report JSON output","compaction_level":0,"original_size":0}
{"id":"bd-1rv","title":"Validate cpu_instrs.gb on CPU and GPU builds","description":"Scope:\n- Benchmark multi-world throughput for CPU vs GPU headless runs (fewer frames, many worlds).\n- Compare total frames/sec and determine if GPU scales vs CPU.\n\nValidation:\n- ./build/headless cpu_instrs.gb 120 256 --benchmark\n- ./build/headless_gpu cpu_instrs.gb 120 256 0 --benchmark","notes":"Added --benchmark/--bench to headless/headless_gpu; benchmark disables rendering/checks. Results (120 frames): CPU 64 worlds ~29.99k fps total, CPU 256 worlds ~37.5k fps total; GPU 64 worlds ~425 fps total (6.65 per world), GPU 256 worlds ~783 fps total (3.06 per world). GPU throughput far below CPU in current madrona setup.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:04.412614668Z","created_by":"bkase","updated_at":"2026-01-20T15:04:32.639821555Z","close_reason":"CPU run passes; GPU run did not complete within 600s timeout","compaction_level":0,"original_size":0}
{"id":"bd-1t0","title":"Implement scanline PPU fast path in display.c","description":"Scope:\n- Implement GB_display_run_scanline(gb, cycles) that advances by LINE_LENGTH and renders a line in one shot.\n- Preserve minimal STAT/LY/VBlank update behavior required for scanline-accurate mode.\nFiles:\n- vendored/SameBoy/Core/display.c\n- vendored/SameBoy/Core/display.h\n- vendored/SameBoy/Core/timing.h\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 600 1","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.495786825Z","created_by":"bkase","updated_at":"2026-01-20T07:08:13.198173813Z","closed_at":"2026-01-20T07:08:13.198117397Z","close_reason":"Implemented scanline display path (cpu_instrs not complete at 600f)","compaction_level":0,"original_size":0}
{"id":"bd-1w9","title":"Extract CuLE paper to markdown and summarize perf notes","description":"Use uv run markitdown to convert https://arxiv.org/pdf/1907.08467 to markdown. Save to docs/cule_paper.md and summarize key perf/design points relevant to GPU throughput.","notes":"CuLE paper key perf notes: GPU renders frames directly to avoid CPU-GPU bandwidth; scales to thousands of envs and reports up to ~155M frames/hour per GPU. Training frames are only 25% of raw frames (rendered 1/4, rest emulated). For <=128 envs, CPU per-env FPS can be higher; GPU advantage grows with many envs (e.g., inference-only median 56K FPS vs 18K FPS CPU at 4096 envs). Paper highlights batching strategies, decoupling inference/training, and notes GPU thread divergence + lower per-thread instruction rate.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:00.231747746Z","created_by":"bkase","updated_at":"2026-01-20T15:14:33.427914569Z","closed_at":"2026-01-20T15:14:33.427855305Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-1w9","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:00.247500242Z","created_by":"bkase"}]}
{"id":"bd-23i","title":"Disable timekeeping and RTC in GPU builds","description":"Scope:\n- Use GB_DISABLE_TIMEKEEPING to compile timing.c without RTC/host time calls on GPU.\n- Stub rtc_run (or early return) and ensure no time() / gettimeofday() is reachable in GPU builds.\nFiles:\n- vendored/SameBoy/Core/timing.c\n- vendored/SameBoy/Core/timing.h\n- vendored/SameBoy/Core/mbc.c\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 10 1 0","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.191768149Z","created_by":"bkase","updated_at":"2026-01-20T04:57:15.105177122Z","closed_at":"2026-01-20T04:57:15.105150898Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-24d","title":"Add sameboy_gpu_config.h with GPU build flags","description":"Scope:\n- Create a dedicated config header (e.g. vendored/SameBoy/Core/sameboy_gpu_config.h) to define GPU-safe macros.\n- Include flags for GB_GPU_MODE, GB_DISABLE_TIMEKEEPING, GB_DISABLE_DEBUGGER, GB_DISABLE_CHEATS, GB_DISABLE_REWIND, GB_DISABLE_AUDIO, GB_DISABLE_FILE_IO.\n- Ensure the header is included by SameBoy core sources when building GPU code.\nFiles:\n- vendored/SameBoy/Core/gb.h\n- vendored/SameBoy/Core/defs.h\n- vendored/SameBoy/Core/sameboy_gpu_config.h (new)\n- src/CMakeLists.txt\nValidation:\n- cmake --build build --target headless_gpu","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:01.900975157Z","created_by":"bkase","updated_at":"2026-01-20T04:19:24.926500668Z","closed_at":"2026-01-20T04:19:24.926442908Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-26x","title":"Benchmark multi-world scaling CPU vs GPU","description":"Run throughput sweeps over world counts (e.g., 1, 8, 32, 64, 128, 256, 512, 1024) with fixed frames (e.g., 120) on CPU/GPU using --benchmark. Record results in history/experiments.md.","notes":"Completed CPU/GPU sweep (120 frames). CPU total FPS: 1=2878, 8=10407, 32=28710, 64=30946, 128=36885, 256=39095, 512=39584, 1024=39827. GPU total FPS: 1=17.56, 8=120.22, 32=314.56, 64=426.99, 128=587.32, 256=778.99, 512=1332.88, 1024=1965.51 (per-world FPS drops with scale).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:12.616754203Z","created_by":"bkase","updated_at":"2026-01-20T15:28:26.025687430Z","closed_at":"2026-01-20T15:28:26.025631301Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-26x","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:12.624308338Z","created_by":"bkase"}]}
{"id":"bd-27e","title":"Avoid floating-point paths on GPU code paths","description":"Scope:\n- Audit GPU-executed paths for float usage and replace with integer math where needed.\n- Ensure GPU observation generation uses integer-only arithmetic.\nFiles:\n- src/sim.cpp\n- vendored/SameBoy/Core/display.c\nValidation:\n- cmake --build build --target headless_gpu","notes":"Avoided float-heavy GPU paths by adding GB_GPU_MODE fast paths in vendored/SameBoy/Core/display.c (linear RGB scaling only; no gamma/temperature pow/round) and joypad.c (faux analog inputs no-op). Verified headless_gpu --benchmark --null-step cpu_instrs.gb 1 1 runs (~3649.64 fps).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.653315268Z","created_by":"bkase","updated_at":"2026-01-20T16:46:11.252890386Z","closed_at":"2026-01-20T16:46:11.252834994Z","close_reason":"GB_GPU_MODE now skips float-heavy color correction (display.c) and faux-analog math (joypad.c); GPU run verified.","compaction_level":0,"original_size":0}
{"id":"bd-29r","title":"Add GB_init_no_alloc API for external memory pointers","description":"Scope:\n- Add GB_init_no_alloc to initialize GB_gameboy_t with external RAM/VRAM/MBC RAM and ROM pointers (no malloc/free).\n- Document the new API in gb.h and adjust initialization to skip internal allocations when used.\nFiles:\n- vendored/SameBoy/Core/gb.h\n- vendored/SameBoy/Core/gb.c\n- vendored/SameBoy/Core/mbc.c\nValidation:\n- cmake --build build --target headless_gpu\n- cmake --build build --target headless","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.061878350Z","created_by":"bkase","updated_at":"2026-01-20T04:34:06.231498111Z","closed_at":"2026-01-20T04:34:06.231441918Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-2bk","title":"Pre-commit hook: run smoke test runner","description":"Add a git pre-commit hook that runs the unified smoke test runner; fail commit on test failure (allow opt-out via env/flag if needed).","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-20T04:03:32.447398147Z","created_by":"bkase","updated_at":"2026-01-20T04:04:02.186004364Z","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2bk","depends_on_id":"bd-cgy","type":"blocks","created_at":"2026-01-20T04:03:36.412437151Z","created_by":"bkase"}]}
{"id":"bd-2dz","title":"Deterministic 2-bit grayscale conversion (0..3)","description":"Scope:\n- Convert framebuffer pixels to 2-bit grayscale values 0..3 deterministically.\n- Avoid floating-point math in the conversion path for GPU determinism.\nFiles:\n- src/sim.cpp\n- src/types.hpp\n- src/consts.hpp\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 60 1","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:02.961632237Z","created_by":"bkase","updated_at":"2026-01-20T03:47:02.961632237Z","compaction_level":0,"original_size":0}
{"id":"bd-2i5","title":"Cache initial states to reduce reset divergence","description":"CuLE caches random initial states to avoid long divergent reset sequences across many envs. Investigate caching GB initial states or shortened reset paths to reduce divergence at reset; measure perf impact.","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-20T22:19:28.180467967Z","created_by":"bkase","updated_at":"2026-01-20T22:19:28.196818901Z","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2i5","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T22:19:28.196795526Z","created_by":"bkase"}]}
{"id":"bd-2jz","title":"Upload ROM to GPU and pass device pointer in Sim::Config","description":"Scope:\n- Allocate ROM on device with cudaMalloc/cudaMemcpy and store the device pointer in Sim::Config.\n- Ensure Sim/GB init uses the device ROM pointer for GPU builds (no host pointer deref on device).\nFiles:\n- src/headless_gpu.cpp\n- src/sim.hpp\n- src/sim.cpp\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 60 1 0","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.765263453Z","created_by":"bkase","updated_at":"2026-01-20T07:14:55.936589763Z","closed_at":"2026-01-20T07:14:55.936534595Z","close_reason":"Already implemented; verified headless_gpu run","compaction_level":0,"original_size":0}
{"id":"bd-2kx","title":"Apply DMG-only + GPU-safe compile flags for SameBoy builds","description":"Scope:\n- Ensure DMG-only configuration is enforced in GPU builds (disable CGB/SGB paths at compile time where supported).\n- Apply GPU-safe compile definitions for SameBoy core and madrona_sameboy_sim.\nFiles:\n- src/CMakeLists.txt\n- vendored/SameBoy/Core/gb.h\n- vendored/SameBoy/Core/model.h\nValidation:\n- cmake --build build --target headless\n- cmake --build build --target headless_gpu","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:01.950845180Z","created_by":"bkase","updated_at":"2026-01-20T04:28:05.918395020Z","closed_at":"2026-01-20T04:28:05.918338284Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-2pl","title":"CPU/GPU compare harness: RAM/VRAM/MBC RAM hashes","description":"Scope:\n- Add a comparison executable that runs CPU and GPU for N frames and hashes RAM/VRAM/MBC RAM.\n- Fail on hash mismatch and print a minimal diff summary.\nFiles:\n- src/CMakeLists.txt\n- src/compare_cpu_gpu.cpp (new)\n- src/sim.hpp\n- src/types.hpp\nValidation:\n- cmake --build build --target compare_cpu_gpu\n- ./build/compare_cpu_gpu cpu_instrs.gb 120","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:03.786962156Z","created_by":"bkase","updated_at":"2026-01-20T07:20:16.475935550Z","closed_at":"2026-01-20T07:20:16.475880606Z","close_reason":"Added compare_cpu_gpu harness; hashes mismatch on cpu_instrs.gb","compaction_level":0,"original_size":0}
{"id":"bd-2tl","title":"Add GPU aggregation TU for SameBoy core C sources","description":"Scope:\n- Add a GPU aggregation translation unit (e.g. src/sameboy_core_gpu.cpp) that includes the SameBoy Core .c files under extern \"C\".\n- Keep the list aligned with SAMEBOY_CORE_SRCS so CPU/GPU builds compile the same core subset.\nFiles:\n- src/CMakeLists.txt\n- src/sameboy_core_gpu.cpp (new)\n- vendored/SameBoy/Core/*.c\nValidation:\n- cmake --build build --target headless_gpu\n- cmake --build build --target headless","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:01.735987481Z","created_by":"bkase","updated_at":"2026-01-20T04:10:32.663685471Z","closed_at":"2026-01-20T04:10:32.663658687Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-2w9","title":"Investigate GPU initWorlds invalid write in StateManager::makeEntityNow","description":"compute-sanitizer reports invalid global write at state.cpp:523 during initWorlds (entity_column[row] = e) even for 1 world. Likely corrupts state and may explain fast_ppu illegal access. Identify root cause and fix; add minimal repro/test or guard. Track findings in history/experiments.md/learnings.md.","notes":"Findings: compute-sanitizer memcheck still flags invalid global write in StateManager::makeEntityNow during initWorlds with GBMachine max entities per world at default (0); nearest allocation reported 2,097,152 bytes with access at +0x4. Reverting max-entities override did not change the error. MADRONA_MWGPU_VERBOSE_HOSTALLOC=1 run (null-step, 1 world) succeeds and shows entity/world column allocations of 8/4 bytes plus larger component buffers, suggesting either compute-sanitizer doesn’t fully track Madrona’s virtual memory allocations or there is a subtle init write that only crashes at scale.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-20T16:10:01.395808712Z","created_by":"bkase","updated_at":"2026-01-20T16:26:56.572384574Z","closed_at":"2026-01-20T16:26:56.572328605Z","close_reason":"Investigation logged: compute-sanitizer still flags initWorlds invalid write even with default max entities; verbose host alloc shows normal allocations for 1 world. Likely Madrona memory API tracking issue or subtle init bug; needs deeper follow-up.","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2w9","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T16:10:01.411642135Z","created_by":"bkase"}]}
{"id":"bd-2zs","title":"Hypothesis: per-frame launch overhead dominates (need multi-frame kernel)","description":"Test running multiple GB frames per kernel launch (e.g., loop inside simTick) to amortize launch/graph overhead. Measure throughput changes.","notes":"Implemented framesPerStep (batched frames per sim step) in sim tick + CLI positional arg (headless/headless_gpu). Benchmark: headless_gpu --benchmark cpu_instrs.gb 120 512 0 4 => 480 frames/world, 1297.16 fps total (2.53 FPS/world), slightly worse than baseline 1332.88 fps. Launch overhead not primary bottleneck.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T15:12:54.057343606Z","created_by":"bkase","updated_at":"2026-01-20T15:43:29.772422456Z","closed_at":"2026-01-20T15:43:29.772367592Z","close_reason":"Completed: batched frames did not improve throughput","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-2zs","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:54.073824825Z","created_by":"bkase"}]}
{"id":"bd-2zt","title":"Tune block size and world count for GPU occupancy","description":"Scope:\n- Expose block size/world count parameters and benchmark to improve occupancy (Blackwell target).\n- Record baseline and tuned throughput numbers.\nFiles:\n- src/headless_gpu.cpp\n- src/sim.hpp\nValidation:\n- ./build/headless_gpu cpu_instrs.gb 600 4096 0","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-20T03:47:05.207383611Z","created_by":"bkase","updated_at":"2026-01-20T17:13:46.279251913Z","closed_at":"2026-01-20T17:13:46.279197433Z","close_reason":"PGO multi-block compile unblocks but blocks>1 hangs; tuning blocked by reg pressure/occupancy","compaction_level":0,"original_size":0}
{"id":"bd-30p","title":"Review NVlabs/cule repo for runtime design differences","description":"Inspect https://github.com/NVlabs/cule for batching/runtime design choices; capture differences vs madrona in notes and hypotheses.","notes":"CuLE repo README notes: repo structure includes cule/, envs/, torchcule/, examples/ (a2c/dqn/ppo/vtrace). GPU env is used via --use-cuda-env (CPU env default), and example configs recommend large env counts (e.g., --num-ales 1200 with minibatching) to effectively leverage GPU throughput. Build via python setup.py install; CUDA 10.0 recommended. This suggests CuLE is optimized around high env counts + batching and tight RL integration (torchcule), unlike our single-world Madrona ECS setup.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:05.209617565Z","created_by":"bkase","updated_at":"2026-01-20T15:17:07.313553541Z","closed_at":"2026-01-20T15:17:07.313497044Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-30p","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:05.225949951Z","created_by":"bkase"}]}
{"id":"bd-358","title":"Keep action/obs buffers on GPU (avoid host copies)","description":"Scope:\n- Ensure GPU path does not copy action/obs buffers each frame; only copy when explicitly requested.\n- Keep device buffers resident across frames in headless_gpu.\nFiles:\n- src/headless_gpu.cpp\n- src/sim.cpp\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 120 1 0","notes":"Checked headless_gpu: input copied once at init; obs readback only after run when not in benchmark. Ran build/headless_gpu cpu_instrs.gb 120 1 0: 120 frames in 6.785s (~17.69 FPS), observation range [0,0]. No per-frame host copies observed.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T03:47:05.001049157Z","created_by":"bkase","updated_at":"2026-01-20T16:49:42.790088008Z","closed_at":"2026-01-20T16:49:42.790060216Z","close_reason":"Verified headless_gpu does not copy action/obs each frame; only initial input upload and optional end readback.","compaction_level":0,"original_size":0}
{"id":"bd-37p","title":"Parallelize PPU rendering across threads per world","description":"CuLE notes TIA rendering can be scheduled with >1 thread per game (e.g., per-scanline/row). Investigate PPU rendering parallelization for GB to increase per-world parallelism; measure perf impact.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T22:19:17.227371165Z","created_by":"bkase","updated_at":"2026-01-20T22:19:17.243503490Z","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-37p","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T22:19:17.243493602Z","created_by":"bkase"}]}
{"id":"bd-3ax","title":"Enable scanline mode via Sim::Config (default on)","description":"Scope:\n- Add a config field to toggle scanline mode and default it to enabled for performance.\n- Plumb the flag through headless/headless_gpu and into GB initialization.\nFiles:\n- src/sim.hpp\n- src/sim.cpp\n- src/headless.cpp\n- src/headless_gpu.cpp\nValidation:\n- cmake --build build --target headless\n- cmake --build build --target headless_gpu","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.411200241Z","created_by":"bkase","updated_at":"2026-01-20T03:47:03.411200241Z","compaction_level":0,"original_size":0}
{"id":"bd-3gq","title":"Hypothesis: instruction-level bottleneck (branch divergence / scalar emu)","description":"Analyze kernel instruction mix / divergence in ncu; compare against CuLE design (vectorized, specialized kernels). Identify if emulator core is inherently ill-suited without custom kernels.","notes":"Tried to assess PPU cost via fast_ppu toggle. Added --fast-ppu config; GPU runs with fast_ppu hit CUDA_ERROR_ILLEGAL_ADDRESS on teardown (120/10 frames, 512 worlds), so fast_ppu path appears GPU-unsafe and blocks using it for perf attribution. Null-step baseline suggests emulator compute/branching dominates overall cost.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T15:13:00.305079814Z","created_by":"bkase","updated_at":"2026-01-20T16:04:51.399500759Z","closed_at":"2026-01-20T16:04:51.399473655Z","close_reason":"Blocked: fast_ppu GPU path triggers illegal access; need GPU-safe fast_ppu or profiler metrics","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3gq","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:13:00.320494421Z","created_by":"bkase"}]}
{"id":"bd-3h4","title":"Nsight Systems multi-world profile","description":"Capture Nsight Systems trace for representative multi-world GPU run (e.g., 256 worlds, 120 frames). Summarize kernel/API hotspots in history/experiments.md.","notes":"Ran nsys profile (512 worlds, 30 frames) and nsys profile --cuda-graph-trace=node (512 worlds, 10 frames). Kernel summary shows madronaMWGPUMegakernel_256_1_48 dominates: 10 instances, ~390 ms avg per frame (~3.90s total), matching ~2.5 FPS. CPU time ~93% in cudaStreamSynchronize (waiting on GPU). Artifacts: history/nsys_gpu_512.nsys-rep/.sqlite and history/nsys_gpu_512_node.nsys-rep/.sqlite.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T15:12:19.008757425Z","created_by":"bkase","updated_at":"2026-01-20T15:30:47.546939993Z","closed_at":"2026-01-20T15:30:47.546913417Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3h4","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:19.025229139Z","created_by":"bkase"}]}
{"id":"bd-3hm","title":"Set fixed seed for SameBoy random logic","description":"Scope:\n- Use a deterministic seed for SameBoy random logic in deterministic/scanline mode.\n- Expose a config or build flag for fixed seed use.\nFiles:\n- vendored/SameBoy/Core/random.c\n- vendored/SameBoy/Core/random.h\n- src/sim.cpp\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 60 1","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.528982142Z","created_by":"bkase","updated_at":"2026-01-20T03:47:03.528982142Z","compaction_level":0,"original_size":0}
{"id":"bd-3ic","title":"Guard malloc/free in SameBoy core for GB_GPU_MODE","description":"Scope:\n- Wrap all malloc/calloc/free in SameBoy core with GB_GPU_MODE guards and use externally provided buffers on GPU.\n- Ensure code paths are safe for device compilation with no host allocation calls.\nFiles:\n- vendored/SameBoy/Core/gb.c\n- vendored/SameBoy/Core/mbc.c\n- vendored/SameBoy/Core/save_state.c\nValidation:\n- cmake --build build --target headless_gpu","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.121551595Z","created_by":"bkase","updated_at":"2026-01-20T04:40:36.659519977Z","closed_at":"2026-01-20T04:40:36.659464873Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-3is","title":"Add consistency tests for downsample/pack pipeline","description":"Scope:\n- Add a small deterministic test that feeds a known 160x144 pattern and validates 80x72 packed output.\n- Integrate the test into CMake/ctest so it runs in CI.\nFiles:\n- src/CMakeLists.txt\n- tests/test_obs_pack.cpp (new)\n- src/types.hpp\nValidation:\n- cmake --build build --target test_obs_pack\n- ctest --test-dir build -R test_obs_pack","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:04.605456333Z","created_by":"bkase","updated_at":"2026-01-20T04:03:49.709967838Z","compaction_level":0,"original_size":0}
{"id":"bd-3r3","title":"CPU/GPU compare harness: packed observation hash","description":"Scope:\n- Extend the CPU/GPU comparison harness to hash packed observations and compare results.\n- Include per-world hashes in the report output.\nFiles:\n- src/compare_cpu_gpu.cpp\n- src/types.hpp\nValidation:\n- cmake --build build --target compare_cpu_gpu\n- ./build/compare_cpu_gpu cpu_instrs.gb 120","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:03.918045069Z","created_by":"bkase","updated_at":"2026-01-20T07:24:00.002497337Z","closed_at":"2026-01-20T07:24:00.002440825Z","close_reason":"Packed obs hash added; cpu_instrs.gb mismatch","compaction_level":0,"original_size":0}
{"id":"bd-5gn","title":"Stub APU/audio behind GB_DISABLE_AUDIO","description":"Scope:\n- Add GB_DISABLE_AUDIO guard to GB_apu_run and any audio mixing/output in SameBoy core.\n- Ensure audio code compiles but is a no-op when disabled.\nFiles:\n- vendored/SameBoy/Core/apu.c\n- vendored/SameBoy/Core/apu.h\nValidation:\n- cmake --build build --target headless_gpu","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.334734815Z","created_by":"bkase","updated_at":"2026-01-20T05:07:08.389394621Z","closed_at":"2026-01-20T05:07:08.389339629Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-877","title":"Export packed observations from Madrona","description":"Scope:\n- Update exportColumn registration to use the packed observation buffer type.\n- Ensure GBObsPacked is exported in both CPU and GPU builds with correct size.\nFiles:\n- src/sim.cpp\n- src/types.hpp\n- src/sim.hpp\nValidation:\n- cmake --build build --target headless\n- cmake --build build --target headless_gpu","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.288915629Z","created_by":"bkase","updated_at":"2026-01-20T03:47:03.288915629Z","compaction_level":0,"original_size":0}
{"id":"bd-aww","title":"Verify headless_gpu builds and runs cpu_instrs.gb","description":"Scope:\n- Confirm the GPU target builds with current compile flags and runs cpu_instrs.gb for a small frame count.\n- Ensure nonzero ROM read failures are surfaced as nonzero exit codes.\nFiles:\n- src/headless_gpu.cpp\n- src/CMakeLists.txt\n- cpu_instrs.gb\nValidation:\n- cmake --build build --target headless_gpu\n- ./build/headless_gpu cpu_instrs.gb 60 1 0","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:01.842604947Z","created_by":"bkase","updated_at":"2026-01-20T06:54:56.307265950Z","closed_at":"2026-01-20T06:54:56.307239358Z","close_reason":"Completed","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-aww","depends_on_id":"bd-23i","type":"blocks","created_at":"2026-01-20T04:15:41.337863845Z","created_by":"bkase"},{"issue_id":"bd-aww","depends_on_id":"bd-24d","type":"blocks","created_at":"2026-01-20T04:15:36.006848784Z","created_by":"bkase"},{"issue_id":"bd-aww","depends_on_id":"bd-2kx","type":"blocks","created_at":"2026-01-20T04:15:38.727714497Z","created_by":"bkase"},{"issue_id":"bd-aww","depends_on_id":"bd-5gn","type":"blocks","created_at":"2026-01-20T04:15:48.312477021Z","created_by":"bkase"},{"issue_id":"bd-aww","depends_on_id":"bd-ho4","type":"blocks","created_at":"2026-01-20T04:15:44.949311034Z","created_by":"bkase"}]}
{"id":"bd-cgy","title":"Unified smoke test runner (build + CPU/GPU compare + headless)","description":"Create a single test entrypoint (script/target) that builds CPU+GPU and runs CPU/GPU compare + headless smoke tests; ensure new tests register here.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-20T04:03:28.767664223Z","created_by":"bkase","updated_at":"2026-01-20T04:03:58.431321322Z","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-cgy","depends_on_id":"bd-16f","type":"blocks","created_at":"2026-01-20T04:03:44.460719314Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-1rp","type":"blocks","created_at":"2026-01-20T04:03:45.194952586Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-1rv","type":"blocks","created_at":"2026-01-20T04:03:44.246810241Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-2pl","type":"blocks","created_at":"2026-01-20T04:03:44.839322488Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-3is","type":"blocks","created_at":"2026-01-20T04:03:45.013852181Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-3r3","type":"blocks","created_at":"2026-01-20T04:03:44.645082712Z","created_by":"bkase"},{"issue_id":"bd-cgy","depends_on_id":"bd-aww","type":"blocks","created_at":"2026-01-20T04:03:44.054593731Z","created_by":"bkase"}]}
{"id":"bd-ho4","title":"Stub save/load file I/O behind GB_DISABLE_FILE_IO","description":"Scope:\n- Add GB_DISABLE_FILE_IO guard to save/load logic so GPU builds do not perform file operations.\n- Ensure save_state APIs return safe defaults when file I/O is disabled.\nFiles:\n- vendored/SameBoy/Core/save_state.c\n- vendored/SameBoy/Core/save_state.h\n- vendored/SameBoy/Core/gb.c\nValidation:\n- cmake --build build --target headless_gpu","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T03:47:02.263634158Z","created_by":"bkase","updated_at":"2026-01-20T05:03:12.152987028Z","closed_at":"2026-01-20T05:03:12.152929877Z","close_reason":"Completed","compaction_level":0,"original_size":0}
{"id":"bd-ohb","title":"Hypothesis: ECS/SoA memory layout dominates (poor locality/pressure)","description":"Use ncu to check memory throughput, cache hit rates; consider a microbench that runs GB_run_frame without ECS indirection or with fused components to compare.","notes":"Added --null-step mode (skip GB_run_frame, touch minimal component data). Results: CPU headless --benchmark --null-step cpu_instrs.gb 120 512 => 143,306 fps total; GPU headless_gpu --benchmark --null-step cpu_instrs.gb 120 512 => 27.7M fps total. ECS/SoA overhead is negligible vs emulator; hypothesis that ECS memory layout dominates is falsified.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T15:12:46.305906624Z","created_by":"bkase","updated_at":"2026-01-20T15:51:50.280380003Z","closed_at":"2026-01-20T15:51:50.280322884Z","close_reason":"Falsified: null-step baseline shows ECS overhead negligible","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-ohb","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T15:12:46.321675281Z","created_by":"bkase"}]}
{"id":"bd-s8q","title":"Update simTick to scanline-driven stepping","description":"Scope:\n- Switch per-tick stepping to use scanline mode (GB_display_run_scanline or GB_run_frame with fast mode enabled).\n- Keep CPU and GPU paths aligned for determinism in scanline mode.\nFiles:\n- src/sim.cpp\n- vendored/SameBoy/Core/gb.h\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 600 1","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:02.860960423Z","created_by":"bkase","updated_at":"2026-01-20T03:47:02.860960423Z","compaction_level":0,"original_size":0}
{"id":"bd-ulc","title":"Split GB step into CPU vs PPU kernels (CuLE-style)","description":"CuLE splits CPU emu and TIA rendering kernels to reduce register pressure/divergence. Investigate splitting GB_run_frame/PPU work into separate taskgraph nodes/kernels; measure perf impact and reg pressure.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T22:19:11.744830968Z","created_by":"bkase","updated_at":"2026-01-20T22:27:22.832910086Z","closed_at":"2026-01-20T22:27:22.832853734Z","close_reason":"Skip-PPU benchmark shows ~3.1x speedup but still far below CPU; true CPU/PPU kernel split would require deeper SameBoy timing decoupling","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-ulc","depends_on_id":"bd-12v","type":"parent-child","created_at":"2026-01-20T22:19:11.752431924Z","created_by":"bkase"}]}
{"id":"bd-zgx","title":"Compile-out unused SameBoy modules for GPU build","description":"Scope:\n- Remove or compile-out non-goal modules in GPU builds (sgb, printer, camera, workboy, rumble).\n- Ensure any references are gated behind GPU config macros or excluded from GPU compilation.\nFiles:\n- vendored/SameBoy/Core/sgb.c\n- vendored/SameBoy/Core/printer.c\n- vendored/SameBoy/Core/camera.c\n- vendored/SameBoy/Core/workboy.c\n- vendored/SameBoy/Core/rumble.c\n- src/CMakeLists.txt\nValidation:\n- cmake --build build --target headless_gpu","notes":"Implemented GPU-only compile-out of camera/printer/rumble/sgb/workboy: removed their .c includes from src/sameboy_core_gpu.cpp and added GPU stubs in src/sameboy_gpu_stubs.c. Initial stub attempt including gb.h caused NVRTC extern \"C\" template errors; fixed by forward-declaring GB_gameboy_t and defining GB_ENUM locally. Verified headless_gpu --benchmark --null-step cpu_instrs.gb 1 1 runs successfully (~2227 fps).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:02.008091604Z","created_by":"bkase","updated_at":"2026-01-20T16:42:00.970482692Z","closed_at":"2026-01-20T16:42:00.970427539Z","close_reason":"GPU-only stubs added and optional module sources removed from GPU TU; verified headless_gpu runs.","compaction_level":0,"original_size":0}
{"id":"bd-zp9","title":"Downsample 2x to 80x72 using 2x2 box filter","description":"Scope:\n- Downsample the 160x144 grayscale buffer to 80x72 using a defined 2x2 box filter (or document chosen method).\n- Ensure the downsample step feeds into packed observation output.\nFiles:\n- src/sim.cpp\n- src/types.hpp\n- src/consts.hpp\nValidation:\n- cmake --build build --target headless\n- ./build/headless cpu_instrs.gb 60 1","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-20T03:47:03.065558912Z","created_by":"bkase","updated_at":"2026-01-20T03:47:03.065558912Z","compaction_level":0,"original_size":0}
